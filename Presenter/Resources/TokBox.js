/*!
 * OpenTok JavaScript Library v0.91.20
 * http://www.tokbox.com/
 *
 * Copyright (c) 2011 TokBox, Inc.
 *
 * Date: July 18 20:34:02 2011
 */

TB=function(){function ag(){this._listeners={};this.addEventListener=function(at,au){if(!at){throw new Error("EventDispatcher.addEventListener :: No type specified")}if(!au){throw new Error("EventDispatcher.addEventListener :: No listener function specified")}if(!this._listeners.hasOwnProperty(at)){this._listeners[at]=new Array()}this.removeEventListener(at,au);E("TB.addEventListener("+at+")");this._listeners[at].push(au)};this.removeEventListener=function(au,av){if(!au){throw new Error("EventDispatcher.removeEventListener :: No type specified")}if(!av){throw new Error("EventDispatcher.removeEventListener :: No listener function specified")}E("TB.removeEventListener("+au+")");if(this._listeners.hasOwnProperty(au)){for(var at=0;at<this._listeners[au].length;at++){if(this._listeners[au][at]==av){this._listeners[au].splice(at,1);break}}}};this.dispatchEvent=function(aw){if(!aw){throw new Error("EventDispatcher.dispatchEvent :: No event specified")}if(!aw.type){throw new Error("EventDispatcher.dispatchEvent :: Event has no type")}if(!aw.target){aw.target=this}if(this._listeners.hasOwnProperty(aw.type)){var av=this._listeners[aw.type];if(av instanceof Array){for(var at=0;at<av.length;at++){var au=al(av[at],aw);setTimeout(au,1)}}else{throw new Error("EventDispatcher.dispatchEvent :: Invalid object type in listeners")}}}}function V(av,at){this.type=av;this.cancelable=at?at:false;this.target;var au=false;this.preventDefault=function(){if(this.cancelable){au=true}else{m("Event.preventDefault :: Trying to preventDefault on an Event that isn't cancelable")}};this.isDefaultPrevented=function(){return au}}function N(at,av,aw,au){this.superClass=V;this.superClass(at);this.message=av;this.title=aw;this.code=au}function y(au,at,av){this.superClass=V;this.superClass(au);this.connections=at;this.reason=av}function a(au,aw,av,at){this.superClass=V;this.superClass(au,at);this.streams=aw;this.reason=av}function P(av,au,aw,at){this.superClass=V;this.superClass(av);this.connections=au;this.streams=aw;this.groups=at}function Z(au,av,at){this.superClass=V;this.superClass(au,at);this.reason=av}function r(at,au){this.superClass=V;this.superClass(at);this.fromConnection=au}function t(au,at,av){this.superClass=V;this.superClass(au);this.camera=at;this.microphone=av}function ad(at,av,au){this.superClass=V;this.superClass(at);this.group=av;this.reason=au}function v(aw,at,av,au,ax){this.superClass=V;this.superClass(aw);this.cameras=at;this.microphones=av;this.selectedCamera=au;this.selectedMicrophone=ax}function g(au,av,at,ax,aw){this.superClass=V;this.superClass(au);this.widthFrom=av;this.widthTo=at;this.heightFrom=ax;this.heightTo=aw}function o(au,aw,ax,at,av){this.superClass=V;this.superClass(au);this.type=au;this.stream=aw;this.changedProperty=ax;this.oldValue=at;this.newValue=av}function h(av,at,au){this.connectionId=av;this.creationTime=Number(at);this.data=au;this.quality}function z(aA,au,ax,ay,az,aw,av,at){this.type=ay;this.creationTime=az;this.hasAudio=aw;this.hasVideo=av;this.orientation=at;this.name=ax;this.connection=au;this.streamId=aA}function L(au,at){this.id=au;this.replacedDivId=at;this.parentClass=ag;this.parentClass()}function ah(aw,au){this.uberClass=L;this.uberClass(aw,au);var at=["showMicButton","showSpeakerButton","showSettingsButton","showCameraToggleButton","nameDisplayMode","buttonDisplayMode"];this.getStyle=function(az){var ax=document.getElementById(this.id);if(!this.loaded){if(az){return this._style[az]}else{return this._style}}else{if(ax){try{var aA=ax.getStyle(az);if(typeof(aA)=="string"){return aA}for(var ay in aA){if(aA[ay]=="false"){aA[ay]=false}if(aA[ay]=="true"){aA[ay]=true}if(at.indexOf(ay)<0){delete aA[ay]}}return aA}catch(aC){var aB="Publisher.getStyle:: Failed to call getStyle. "+aC;I(aB);throw new Error(aB)}}else{aB="Publisher.getStyle:: Publisher "+this.id+" does not exist.";I(aB);throw new Error(aB)}}};this._style={};var av={buttonDisplayMode:["auto","off","on"],nameDisplayMode:["auto","off","on"],showSettingsButton:[true,false],showMicButton:[true,false],showCameraToggleButton:[true,false]};this.setStyle=function(az,aC){E("Publisher.setStyle");var ax=document.getElementById(this.id);if(!this.loaded){if((typeof(az)=="string")&&aC!=null){if(this._style.hasOwnProperty(az)&&av[az].indexOf(aC)>-1){E("setStyle::Setting "+az+" to "+aC);this._style[az]=aC}else{m("setStyle::Invalid style property passed "+az+" : "+aC)}}else{for(var ay in az){this.setStyle(ay,az[ay])}}this.modified=true}else{if(ax){try{ax.setStyle(az,aC)}catch(aB){var aA="Publisher.setStyle:: Failed to call setStyle. "+aB;I(aA);throw new Error(aA)}}else{aA="Publisher.setStyle:: Publisher "+this.id+" does not exist.";I(aA);throw new Error(aA)}}return this}}function F(av,au,at){this.superClass=ah;this.superClass(av,au);this._style={showMicButton:true,showSettingsButton:true,showCameraToggleButton:true,nameDisplayMode:"auto",buttonDisplayMode:"auto"};if(at&&at.hasOwnProperty("style")){this.setStyle(at.style)}this.properties=at;this.loaded=false;this.modified=false;this.panelId=null;this.gain=50;if(at&&at.hasOwnProperty("microphoneGain")){this.gain=parseInt(at.microphoneGain,10)}this.enableMicrophone=function(){this.publishAudio(true)};this.disableMicrophone=function(){this.publishAudio(false)};this.setMicrophoneGain=function(az){var aw=document.getElementById(this.id);if(!this.loaded){this.gain=az;this.modified=true}else{if(aw){try{aw.setMicGain(az)}catch(ay){var ax="Microphone gain adjustment on publisher "+this.id+" failed";I(ax);throw new Error(ax)}}else{ax="Publisher "+this.id+" does not exist.";I(ax);throw new Error(ax)}}return this};this.getMicrophoneGain=function(){var aw=document.getElementById(this.id);if(!this.loaded){return this.gain}else{if(aw){try{return aw.getMicGain()}catch(ay){var ax="Microphone gain adjustment on publisher "+this.id+" failed";I(ax);throw new Error(ax)}}else{ax="Publisher "+this.id+" does not exist.";I(ax);throw new Error(ax)}}};this.getEchoCancellationMode=function(){E("Publisher.getEchoCancellationMode()");var az="";var aw=document.getElementById(this.id);if(!this.loaded){return"unknown"}else{if(aw){try{az=aw.getEchoCancellationMode()}catch(ay){var ax="Getting echo cancellation mode for publisher "+this.id+" failed. "+ay;I(ax);throw new Error(ax)}}else{ax="Publisher "+this.id+" does not exist.";I(ax);throw new Error(ax)}}return az};this.publishAudio=function(aw){E("Publisher.publishAudio()");if(!this.loaded){this.audioPublished=aw;this.modified=true}else{am(this.id,"publishAudio",aw)}};this.publishVideo=function(aw){E("Publisher.publishVideo()");if(!this.loaded){this.videoPublished=aw;this.modified=true}else{am(this.id,"publishVideo",aw)}};this.setCamera=function(aw){E("Publisher.setCamera("+aw+")");M(this.id,aw,true)};this.setMicrophone=function(aw){E("Publisher.setMicrophone("+aw+")");M(this.id,aw,false)};this.getImgData=function(){E("Publisher.getImgData");var aw=document.getElementById(this.id);if(aw){try{return aw.getImgData()}catch(ay){var ax="Publisher.getImgData:: Failed to call getImgData. "+ay;I(ax);throw new Error(ax)}}else{ax="Publisher.getImgData:: Publisher "+this.id+" does not exist.";I(ax);throw new Error(ax)}}}function J(ax,ay,aw,au){this.superClass=ah;this.superClass(ay,aw);this._style={nameDisplayMode:"auto",buttonDisplayMode:"auto"};if(au&&au.hasOwnProperty("style")){this.setStyle(au.style)}this.stream=ax;this.properties=au;this.loaded=false;this.modified=false;this.audioVolume=50;var at=true;var av=true;if(au){if(au.hasOwnProperty("subscribeToAudio")&&(au.subscribeToAudio=="false"||au.subscribeToAudio==false)){at=false}if(au.hasOwnProperty("subscribeToVideo")&&(au.subscribeToVideo=="false"||au.subscribeToVideo==false)){av=false}if(au.hasOwnProperty("audioVolume")){this.audioVolume=parseInt(au.audioVolume,10)}}this.enableAudio=function(){this.subscribeToAudio(true)};this.disableAudio=function(){this.subscribeToAudio(false)};this.setAudioVolume=function(aC){var az=document.getElementById(this.id);if(!this.loaded){this.audioVolume=aC}else{if(az){try{az.setAudioVolume(aC)}catch(aB){var aA="Volume adjustment on subscriber "+this.id+" failed";I(aA);throw new Error(aA)}}else{aA="Subscriber "+this.id+" does not exist.";I(aA);throw new Error(aA)}}return this};this.getAudioVolume=function(){var az=document.getElementById(this.id);if(!this.loaded){return this.audioVolume}if(az){try{return az.getAudioVolume()}catch(aB){var aA="Volume adjustment on subscriber "+this.id+" failed";I(aA);throw new Error(aA)}}else{aA="Subscriber "+this.id+" does not exist.";I(aA);throw new Error(aA)}return this};this.getImgData=function(){E("Subscriber.getImgData");var az=document.getElementById(this.id);if(az){return az.getImgData()}else{errorMsg="Subscriber "+ay+" does not exist.";I(errorMsg);throw new Error(errorMsg)}};this._subscribeToAudio=function(az,aA){E("Subscriber.subscribeToAudio()");if(!aA||at){if(!this.loaded){this.audioSubscribed=az;this.modified=true}else{am(this.id,"subscribeToAudio",az)}}};this.subscribeToAudio=function(az){at=az;this._subscribeToAudio(at,false)};this._subscribeToVideo=function(az,aA){E("Subscriber.subscribeToVideo()");if(!aA||av){if(!this.loaded){this.videoSubscribed=az;this.modified=true}else{am(this.id,"subscribeToVideo",az)}}};this.subscribeToVideo=function(az){av=az;this._subscribeToVideo(av,false)};this.changeOrientation=function(az){E("Subscriber.changeOrientation()");am(this.id,"changeOrientation",az)}}function O(aw,av,au,at){this.superClass=L;this.superClass(aw,av);if(au){this.publisher=au}else{this.publisher=null}this.parentCreated=false;this.properties=at}function ae(au,at){this.name=au;this.status=at}function n(au,at){this.name=au;this.status=at}function e(au,at){this.superClass=ag;this.superClass();this.groupId=at;this.sessionId=au;this.enableEchoSuppression=function(){E("Group.enableEchoSuppresion()");aq(this.sessionId,this.groupId,true)};this.disableEchoSuppression=function(){E("Group.disableEchoSuppression()");aq(this.sessionId,this.groupId,false)};this.getGroupProperties=function(){E("Group.getGroupProperties()");return ai(this.sessionId,this.groupId)}}function W(at){this.isEnabled=at}function ap(av,au,at){this.numOutputStreams=av;this.switchType=au;this.switchTimeout=at}function S(at){this.echoSuppression=new W(at.echoSuppressionEnabled);this.multiplexer=new ap(at.multiplexerNumOutputStreams,at.multiplexerSwitchType,at.multiplexerSwitchTimeout)}function x(ax){this.superClass=ag;this.superClass();this.apiKey=ax;this.panels={};this.showMicSettings=true;this.showCamSettings=true;var au=360;var aw=270;var at=340;var av=230;this.detectDevices=function(){E("DeviceManager.detectDevices()");if(!u){var aC={};aC.allowscriptaccess="always";u="opentok_deviceDetector";var ay={};ay.id=u;var az={};swfobject.addDomLoadEvent(function(){var aD=document.createElement("div");aD.setAttribute("id",u);aD.style.display="none";document.body.appendChild(aD);swfobject.embedSWF(aj+"/v0.91.20.201107182034/flash/f_devicedetectorwidget.swf?partnerId="+ax,u,1,1,"10.0.0",false,az,aC,ay)})}else{try{var aA=document.getElementById(u);aA.detectDevices()}catch(aB){I(aB);throw new Error("DeviceManager.detectDevices() :: Failed to locate existing device detector "+aB)}}};this.displayPanel=function(aB,aK,aC){E("DeviceManager.displayPanel("+aB+")");var aQ;if(aK){aQ="displayPanel_"+aK.id}else{aQ="displayPanel_global"}if(aK&&TB.sessions){for(var aN in TB.sessions){if(TB.sessions[aN].hasOwnProperty("disconnect")&&TB.sessions[aN].publishers[aK.id]){TB.sessions[aN].publishers[aK.id].panelId=aQ}}}var aL=document.getElementById(aQ);if(aL){m("DeviceManager.displayPanel :: there is already a device panel"+(aK?" for this publisher":""));return this.panels[aQ]}var aF=false;var aH=(aC)?aC:{};var aO={};aO.allowscriptaccess="always";var aM=au;var aJ=aw;if("showCloseButton" in aH){if(aH.showCloseButton==false){aM=at;aJ=av}}else{aH.showCloseButton=true}if(!("showMicSettings" in aH)){aH.showMicSettings=this.showMicSettings}if(!("showCamSettings" in aH)){aH.showCamSettings=this.showCamSettings}if(!aB){aB="devicePanel_replace_div";var aG=document.createElement("div");aG.setAttribute("id",aB);var aA=document.createElement("div");aA.setAttribute("id","devicePanel_parent_"+(aK?aK.id:"global"));aA.style.position="absolute";var aE=("pageYOffset" in window&&typeof(window.pageYOffset)=="number")?window.pageYOffset:(document.body&&document.body.scrollTop)?document.body.scrollTop:(document.documentElement&&document.documentElement.scrollTop)?document.documentElement.scrollTop:0;var az=("innerHeight" in window)?window.innerHeight:(document.documentElement&&document.documentElement.offsetHeight)?document.documentElement.offsetHeight:aw;aE+=(az*0.2);aA.style.top=aE+"px";aA.style.left="50%";aA.style.width=aM+"px";aA.style.height=aJ+"px";aA.style.marginLeft=(0-aM/2)+"px";aA.style.marginTop=(0-aJ/4)+"px";if("zIndex" in aH){aA.style.zIndex=aH.zIndex;delete aH.zIndex}else{aA.style.zIndex=ac()+1}document.body.appendChild(aA);aF=true;aA.appendChild(aG)}var aI=document.getElementById(aB);if(!aI){var ay="DeviceManager.displayPanel :: replaceElementId does not exist in DOM.";I(ay);throw new Error(ay)}var aP;if(this.panels[aQ]){this.removePanel(this.panels[aQ])}if(aK){aP=new O(aQ,aB,aK,aH)}else{aP=new O(aQ,aB,null,aH)}aP.parentCreated=aF;this.panels[aQ]=aP;var aD={};aD.id=aP.id;aD.style="outline:none;";aH.devicePanelId=aQ;if(aH.wmode){aO.wmode=aH.wmode;delete aH.wmode}else{aO.wmode="transparent"}A(aj+"/v0.91.20.201107182034/flash/f_devicewidget.swf?partnerId="+this.apiKey,aB,aM,aJ,ar,false,aH,aO,aD);return aP};this.removePanel=function(az){if(!az.hasOwnProperty("id")){var aF="DeviceManager.removePanel :: invalid DevicePanel object";I(aF);throw new Error(aF)}E("DeviceManager.removePanel("+az.id+")");var aE=document.getElementById(az.id);if(!aE){aF="DeviceManager.removePanel :: DevicePanel does not exist in DOM";I(aF);throw new Error(aF)}var aH=aE.parentNode;var aG=az.parentCreated;for(var aB in this.panels){if(this.panels[aB].hasOwnProperty("id")&&aB==az.id){var ay=this.panels[aB];T(this.panels[aB]);delete this.panels[aB];var aC=function(){if(ay.publisher&&TB.sessions){for(var aI in TB.sessions){if(TB.sessions[aI].hasOwnProperty("disconnect")&&TB.sessions[aI].publishers[ay.publisher.id]){TB.sessions[aI].publishers[ay.publisher.id].panelId=null}}}};setTimeout(aC,2)}}if(aG){try{var aD=aH.parentNode;aD.removeChild(aH)}catch(aA){aF="Failed to clean up the parent of the device panel "+aA;I(aF);throw new Error(aF)}}}}function G(ay){this.superClass=ag;this.superClass();this.sessionId=ay;this.connection;this.subscribers={};this.publishers={};this.apiKey;this.capabilities;this.connected=false;this.connecting=false;var au=1;var ax=1;var at=264;var av=198;var aw;this.connect=function(aG,aC,aB){if(this.connecting){m("Session.connect :: Patience, please.");return}E("Session.connect("+aG+")");if(!TB.checkSystemRequirements()){var aD="Session.connect :: Flash Player Version 10+ required";I(aD);throw new Error(aD)}if(!aG){aD="Session.connect :: API key required to connect";I(aD);throw new Error(aD)}if(!aC){aD="Session.connect :: Token required to connect";I(aD);throw new Error(aD)}if(this.connected){m("Session.connect :: Session already connected");return}this.connecting=true;var az=(aB)?aB:{};this.apiKey=aG;this.token=aC;this.properties=aB;var aF={};aF.allowscriptaccess="always";if(az.wmode){aF.wmode=az.wmode;delete az.wmode}aw="controller_"+this.sessionId;var aA={};aA.id=aw;az.sessionId=this.sessionId;az.token=this.token;var aE="replace_"+this.sessionId;swfobject.addDomLoadEvent(function(){var aH=document.createElement("div");aH.setAttribute("id",aE);aH.style.display="none";document.body.appendChild(aH);swfobject.embedSWF(aj+"/v0.91.20.201107182034/flash/f_controllerwidget.swf?partnerId="+aG,aE,1,1,ar,false,az,aF,aA)});if(window.location.protocol=="file:"){setTimeout("TB.controllerLoadCheck()",8000)}};this.disconnect=function(){E("Session.disconnect()");if(!aw||this.connecting){m("Session.disconnect :: No connection to disconnect");return}var az=document.getElementById(aw);if(az){try{az.cleanupView()}catch(aB){var aA="Session.disconnect :: Failed to disconnect - "+aB;I(aA);throw new Error(aA)}}else{m("Session.disconnect :: No connection to disconnect")}};this.disconnectComponents=function(){E("Session.disconnectComponents() - disconnecting publishers and subscribers");for(var aA in this.publishers){if(this.publishers[aA].hasOwnProperty("id")){U(this.publishers[aA])}}for(var az in this.subscribers){if(this.subscribers[az].hasOwnProperty("id")){U(this.subscribers[az])}}};this.cleanup=function(){E("Session.cleanup()");for(var aA in this.publishers){if(this.publishers[aA].hasOwnProperty("id")){this.unpublish(this.publishers[aA])}}for(var az in this.subscribers){if(this.subscribers[az].hasOwnProperty("id")){this.unsubscribe(this.subscribers[az])}}};this.cleanupConnection=function(){E("Session.cleanupConnection() - removing controller");this.connection=null;if(!aw){m("Session.cleanup :: No connection to clean up");return}if(document.getElementById(aw)){setTimeout(function(){B(aw,"TB.sessionDisconnected :: ");aw=null},0)}else{m("Session.cleanup :: No connection to clean up")}};this.publish=function(aI,aH){E("Session.publish("+aI+")");if(!this.connection||!this.connection.connectionId){var aF="Session.publish :: Connection required to publish";I(aF);throw new Error(aF)}if(!aI){var aA=document.createElement("div");aI="publisher_replace_"+this.sessionId+"_"+au;aA.setAttribute("id",aI);document.body.appendChild(aA)}var aC=document.getElementById(aI);if(!aC){aF="Session.publish :: replaceElementId does not exist in DOM.";I(aF);throw new Error(aF)}var aE=(aH)?aH:{};var aG="publisher_"+this.sessionId+"_"+au++;var aB={};aB.allowscriptaccess="always";aB.cameraSelected=b;if(aE.wmode){aB.wmode=aE.wmode;delete aE.wmode}else{aB.wmode="transparent"}if(aE.hasOwnProperty("style")){aE.style=R(aE.style)}var aD={};aD.id=aG;aD.style="outline:none;";aE.publisherId=aG;aE.connectionId=this.connection.connectionId;aE.sessionId=this.sessionId;aE.token=this.token;aE.cameraSelected=b;aE.simulateMobile=TB.simulateMobile;if(!aE.width||isNaN(aE.width)){aE.width=at}if(!aE.height||isNaN(aE.height)){aE.height=av}var az=new F(aG,aI,aE);this.publishers[aG]=az;A(aj+"/v0.91.20.201107182034/flash/f_publishwidget.swf?partnerId="+this.apiKey,aI,aE.width,aE.height,ar,false,aE,aB,aD);return az};this.unpublish=function(aA){if(!aA){var az="Session.unpublish :: publisher cannot be null";I(az);throw new Error(az)}E("Session.unpublish("+aA.id+")");if(aA.panelId&&Y&&Y.panels[aA.panelId]){T(Y.panels[aA.panelId]);delete Y.panels[aA.panelId]}T(aA);delete this.publishers[aA.id]};this.forceUnpublish=function(aD){var aC;if(aD&&typeof(aD)=="string"){aC=aD}else{if(aD&&typeof(aD)=="object"&&aD.hasOwnProperty("streamId")){aC=aD.streamId}else{var aB="Session.forceUnpublish :: Invalid stream type";I(aB);throw new Error(aB)}}E("Session.forceUnpublish("+aC+")");if(aC){try{var az=document.getElementById(aw);az.forceUnpublish(aC)}catch(aA){aB="Session.forceUnpublish :: "+aA;I(aB);throw new Error(aB)}}else{aB="Session.forceUnpublish :: Stream does not exist.";I(aB);throw new Error(aB)}};this.subscribe=function(aI,aG,aF){if(!this.connection||!this.connection.connectionId){var aE="Session.subscribe :: Connection required to subscribe";I(aE);throw new Error(aE)}if(!aI){aE="Session.subscribe :: stream cannot be null";I(aE);throw new Error(aE)}if(!aI.hasOwnProperty("streamId")){aE="Session.subscribe :: invalid stream object";I(aE);throw new Error(aE)}E("Session.subscribe("+aI.streamId+")");if(!aG){var az=document.createElement("div");aG="subscriber_replace_"+this.sessionId+"_"+ax;az.setAttribute("id",aG);document.body.appendChild(az)}var aB=document.getElementById(aG);if(!aB){aE="Session.subscribe :: replaceElementId does not exist in DOM.";I(aE);throw new Error(aE)}var aD=(aF)?aF:{};if(aI&&aI.hasOwnProperty("type")&&aI.type=="multiplexed"){aD.mixedStreamURI="live-lowlatency"}var aH="subscriber_"+aI.streamId+"_"+ax++;var aJ=new J(aI,aH,aG,aD);var aA={};aA.allowscriptaccess="always";if(aD.wmode){aA.wmode=aD.wmode;delete aD.wmode}else{aA.wmode="transparent"}if(aD.hasOwnProperty("style")){aD.style=R(aD.style)}var aC={};aC.id=aJ.id;aC.style="outline:none;";aD.subscriberId=aH;aD.connectionId=this.connection.connectionId;aD.sessionId=this.sessionId;aD.streamId=aI.streamId;aD.name=aI.name;aD.token=this.token;aD.simulateMobile=TB.simulateMobile;if(!aI.hasAudio){aD.subscribeToAudio="false"}if(!aI.hasVideo){aD.subscribeToVideo="false"}aD.orientation=aI.orientation;if(!aD.width||isNaN(aD.width)){aD.width=at}if(!aD.height||isNaN(aD.height)){aD.height=av}this.subscribers[aJ.id]=aJ;A(aj+"/v0.91.20.201107182034/flash/f_subscribewidget.swf?partnerId="+this.apiKey,aG,aD.width,aD.height,ar,false,aD,aA,aC);return aJ};this.unsubscribe=function(az){if(!az){var aA="Subscribe.unsubscribe :: subscriber cannot be null";I(aA);throw new Error(aA)}E("Session.unsubscribe("+az.id+")");T(az);delete this.subscribers[az.id]};this.signal=function(){E("Session.signal()");if(aw&&this.connection&&this.connection.connectionId){try{var az=document.getElementById(aw);az.sendSignal()}catch(aB){var aA="Session.signal :: "+aB;I(aA);throw new Error(aA)}}else{aA="Session.signal :: Connection required to signal.";I(aA);throw new Error(aA)}};this.forceDisconnect=function(aA){if(aA){E("Session.forceDisconnect("+aA.connectionId+")")}var aD;if(aA&&typeof(aA)=="string"){aD=aA}else{if(aA&&typeof(aA)=="object"&&aA.hasOwnProperty("connectionId")){aD=aA.connectionId}else{var aC="Session.forceDisconnect :: Invalid connection type";I(aC);throw new Error(aC)}}if(aw&&this.connection&&this.connection.connectionId){try{var az=document.getElementById(aw);az.forceDisconnect(aD)}catch(aB){aC="Session.forceDisconnect :: "+aB;I(aC);throw new Error(aC)}}else{aC="Session.forceDisconnect :: Connection required to forceDisconnect.";I(aC);throw new Error(aC)}};this.getSubscribersForStream=function(aD){var az=null;if(!aD){var aB="Session.getSubscribersForStream :: stream cannot be null";I(aB);throw new Error(aB)}else{var aC;if(typeof(aD)=="string"){aC=aD}else{if(typeof(aD)=="object"&&aD.hasOwnProperty("streamId")){aC=aD.streamId}else{aB="Session.getSubscribersForStream :: Invalid stream type";I(aB);throw new Error(aB)}}az=[];for(var aA in this.subscribers){if(this.subscribers[aA].hasOwnProperty("stream")&&this.subscribers[aA].stream.streamId==aC){az.push(this.subscribers[aA])}}}return az};this.getPublisherForStream=function(aE){if(!aE){var aC="Session.getPublisherForStream :: stream cannot be null";I(aC);throw new Error(aC)}else{var aD;if(typeof(aE)=="string"){aD=aE}else{if(typeof(aE)=="object"&&aE.hasOwnProperty("streamId")){aD=aE.streamId}else{aC="Session.getPublisherForStream :: Invalid stream type";I(aC);throw new Error(aC)}}for(var aB in this.publishers){var aA=document.getElementById(this.publishers[aB].id);if(aA){try{if(aA.getStreamId()==aD){return this.publishers[aB]}}catch(az){m("Failed to get streamId for publisher: "+this.publishers[aB].id)}}}}return null}}function aq(ay,au,av){try{var at=document.getElementById("controller_"+ay);at.setEchoSuppressionEnabled(au,av)}catch(ax){var aw="Group :: "+ax;I(aw);throw new Error(aw)}}function ai(az,av){var au=null;try{var at=document.getElementById("controller_"+az);var ay=at.getGroupProperties(av);au=new S(ay)}catch(ax){var aw="Group :: "+ax;I(aw);throw new Error(aw)}return au}function c(at){if(!at.success){I("Failed to embed SWF "+at.id);TB.exceptionHandler("Failed to embed SWF "+at.id,"Embed Failed",2001)}}function A(aw,aB,ay,aA,at,av,au,ax,az){if(!swfobject.hasFlashPlayerVersion(at)){I("Flash Player "+at+" or higher required");TB.exceptionHandler("Flash Player "+at+" or higher required","Embed Failed",2001);return}swfobject.embedSWF(aw,aB,ay,aA,at,av,au,ax,az,c)}function al(au,at){return function(){if(au!=null){au(at)}else{I("Event handler is null")}}}function k(at){window.opentokdebug.debug("[FLASHDEBUG] opentok: "+at)}function E(at){window.opentokdebug.debug("[DEBUG] opentok: "+at)}function ak(at){window.opentokdebug.info("[INFO] opentok: "+at)}function m(at){window.opentokdebug.warn("[WARN] opentok: "+at)}function I(at){window.opentokdebug.error("[ERROR] opentok: "+at)}function l(av,au){var at=document.getElementById("opentok_console");if(at){at.innerHTML+=(au+"<br>")}}function D(au){if(w.hasOwnProperty(au)){var at=w[au]}else{at=new h(au,NaN,null)}return at}function C(at){return new z(at.streamId,D(at.connectionId),at.name,at.type,at.creationTime,at.hasAudio,at.hasVideo,at.orientation)}function aa(au){var av=[];for(var at=0;at<au.length;at++){av.push(C(au[at]))}return av}function ao(au){var aw=[];for(var av=0;av<au.length;av++){var at=new h(au[av].connectionId,au[av].creationTime,au[av].data);aw.push(at);w[at.connectionId]=at}return aw}function X(aw,av){var at=[];for(var au in av){if(av[au].hasOwnProperty("groupId")){at.push(new e(aw,av[au].groupId))}}return at}function an(at){if(at.status==TB.ACTIVE){return new ae(at.name,TB.ACTIVE)}else{if(at.status==TB.INACTIVE){return new ae(at.name,TB.INACTIVE)}else{return new ae(at.name,TB.UNKNOWN)}}}function K(at){return new n(at.name,at.status)}function q(at){var av=new Array();for(var au=0;au<at.length;au++){av.push(new ae(at[au].name,at[au].status))}return av}function j(at){var av=new Array();for(var au=0;au<at.length;au++){av.push(new n(at[au].name,at[au].status))}return av}function U(at){if(!at.hasOwnProperty("id")){return}var au=document.getElementById(at.id);if(au){try{au.cleanupView()}catch(av){m("Disconnecting "+at.id+" failed")}}else{m("Disconnecting "+at.id+" failed")}}function T(au){var av=document.getElementById(au.id);if(av){try{av.cleanupView();var at=av.parentNode;at.removeChild(av)}catch(aw){m("Removing "+au.id+" failed "+aw)}}else{m("Element "+au.id+" does not exist")}}function B(at,aw){try{if(at){swfobject.removeSWF(at);at=null}}catch(av){var au=aw+av;I(au);TB.exceptionHandler(au,"Internal Error",2000)}}function am(ay,ax,aw){var at=document.getElementById(ay);if(at){try{at.setStreamProperty(ax,aw)}catch(av){var au="Changing settings on component "+ay+" failed.";I(au);throw new Error(au)}}else{au="Component "+ay+" does not exist.";I(au);throw new Error(au)}}function M(ay,ax,at){var au=document.getElementById(ay);if(au){try{if(at){au.setCamera(ax.name)}else{au.setMicrophone(ax.name)}}catch(aw){var av="Changing hardware settings on publisher "+ay+" failed.";I(av);throw new Error(av)}}else{av="Publisher "+ay+" does not exist.";I(av);throw new Error(av)}}function ac(az,aw){aw=aw||Infinity;az=az||document.body;var aA,aB,ay=1,av=[],ax=0;var au=az.childNodes,at=au.length;while(ax<at){aA=au[ax++];if(aA.nodeType!=1){continue}if(i(aA,"position")!=="static"){aB=i(aA,"z-index");if(aB=="auto"){aB=ac(aA)}else{aB=parseInt(aB,10)||0}}else{aB=ac(aA)}if(aB>ay&&aB<=aw){ay=aB}}return ay}function i(aw,av){var at,ax,au=document.defaultView||window;if(aw.nodeType==1){at=av.replace(/\-([a-z])/g,function(az,ay){return ay.toUpperCase()});ax=aw.style[at];if(!ax){if(aw.currentStyle){ax=aw.currentStyle[at]}else{if(au.getComputedStyle){ax=au.getComputedStyle(aw,"").getPropertyValue(av)}}}}return ax||""}function ab(av,au,aw){var at=document.createElement("input");at.setAttribute("name",au);at.setAttribute("value",aw);at.setAttribute("type","hidden");av.appendChild(at)}function s(at){try{var au=document.getElementById(at);if(au){return au.fetchData()}}catch(av){m("Failed to get logs for "+at+" "+av);return""}}function R(au){var at="{ ";for(var av in au){if(typeof(au[av])=="boolean"){at+='"'+av+'":'+au[av]+", "}else{at+='"'+av+'":"'+au[av].toString()+'", '}}if(at.length>1){at=at.substring(0,at.length-2)+" }"}else{at="{}"}return at}window.onunload=function(){for(var at in TB.sessions){if(TB.sessions[at].hasOwnProperty("disconnect")){TB.sessionDisconnectedHandler=function(){};TB.sessions[at].disconnect();TB.sessions[at].cleanupConnection();TB.sessions[at].cleanup()}}};var ar="10.0.0";var af=215;var Q=138;var Y;var u;var b=false;var f=false;var w={};var p="true";var aj="http://static.opentok.com";if(p=="true"&&window.location.protocol=="https:"){aj="https://swww.tokbox.com"}var H=new ag();var d=false;return{sessions:{},groups:{},LOG:5,DEBUG:4,INFO:3,WARN:2,ERROR:1,NONE:0,ACTIVE:"active",INACTIVE:"inactive",UNKNOWN:"unknown",EXCEPTION:"exception",SESSION_CONNECTED:"sessionConnected",SESSION_DISCONNECTED:"sessionDisconnected",STREAM_CREATED:"streamCreated",STREAM_DESTROYED:"streamDestroyed",CONNECTION_CREATED:"connectionCreated",CONNECTION_DESTROYED:"connectionDestroyed",SIGNAL_RECEIVED:"signalReceived",STREAM_PROPERTY_CHANGED:"streamPropertyChanged",GROUP_PROPERTIES_UPDATED:"groupPropertiesUpdated",RESIZE:"resize",SETTINGS_BUTTON_CLICK:"settingsButtonClick",DEVICE_INACTIVE:"deviceInactive",ACCESS_ALLOWED:"accessAllowed",ACCESS_DENIED:"accessDenied",ECHO_CANCELLATION_MODE_CHANGED:"echoCancellationModeChanged",DEVICES_DETECTED:"devicesDetected",DEVICES_SELECTED:"devicesSelected",CLOSE_BUTTON_CLICK:"closeButtonClick",HAS_REQUIREMENTS:1,OLD_FLASH_VERSION:0,BASIC_STREAM:"basic",MULTIPLEXED_STREAM:"multiplexed",GLOBAL_GROUP:"global",MULTIPLEXER_TIMEOUT_BASED_SWITCH:0,MULTIPLEXER_ACTIVITY_BASED_SWITCH:1,simulateMobile:false,setLogLevel:function(at){window.opentokdebug.setLevel(at);if(at==this.NONE){window.opentokdebug.setCallback(null)}else{window.opentokdebug.setCallback(l,true)}E("TB.setLogLevel("+at+")")},log:function(at){window.opentokdebug.log("[LOG] opentok: "+at)},initSession:function(au){E("TB.initSession("+au+")");if(au==null||au==""){var at="TB.initSession :: sessionId cannot be null";I(at);throw new Error(at)}if(!this.sessions.hasOwnProperty(au)){this.sessions[au]=new G(au)}return this.sessions[au]},initDeviceManager:function(au){E("TB.initDeviceManager("+au+")");if(!au){var at="TB.initDeviceManager :: apiKey cannot be null";I(at);throw new Error(at)}if(!Y){Y=new x(au)}return Y},addEventListener:function(at,au){E("TB.addEventListener("+at+")");H.addEventListener(at,au)},removeEventListener:function(at,au){E("TB.removeEventListener("+at+")");H.removeEventListener(at,au)},dispatchEvent:function(at){E("TB.dispatchEvent()");at.target=this;H.dispatchEvent(at)},checkSystemRequirements:function(){E("TB.checkSystemRequirements()");return swfobject.hasFlashPlayerVersion(ar)?this.HAS_REQUIREMENTS:this.OLD_FLASH_VERSION},exceptionHandler:function(ax,aw,av){I("TB.exception :: title: "+aw+" msg: "+ax+" errorCode: "+av);try{this.dispatchEvent(new N(this.EXCEPTION,ax,aw,av))}catch(au){var at="TB.exception :: Failed to dispatch exception - "+au;I(at)}},controllerLoadedHandler:function(){d=true},controllerLoadCheck:function(au){if(!d){var at="The connection timed out. Make sure that you have allowed this page in theFlash Player Global Settings Manager. Go to:";adobeURL="http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html";prompt(at,adobeURL)}},flashLogger:function(at){k(at)},destroyStreamHandler:function(ay,at){E("TB.destroyStream");try{var ax=this.sessions[ay];var az=aa(at);var aw=function(){for(var aA=0;aA<az.length;aA++){var aB=ax.getPublisherForStream(az[aA]);if(aB){ax.unpublish(aB)}}};setTimeout(aw,2)}catch(av){var au="TB.destroyStream :: "+av;I(au);TB.exceptionHandler(au,"Internal Error",2000)}},sessionConnectedHandler:function(aA,aC,at,aw,au,av,aE){E("TB.sessionConnected");try{var aD=this.sessions[aA];for(az=0,len=at.length;az<len;az++){connection=at[az];if(connection.connectionId==aC){aD.connection=new h(aC,connection.creationTime,connection.data);break}}aD.connected=true;aD.connecting=false;aD.connection.quality=aE;aD.capabilities=av;var aG=ao(at);var aF=aa(aw);var ax=X(aA,au);for(var az=0;az<ax.length;az++){this.groups[aA+"_"+ax[az].groupId]=ax[az]}aD.dispatchEvent(new P(this.SESSION_CONNECTED,aG,aF,ax))}catch(ay){var aB="TB.sessionConnected :: "+ay;I(aB);TB.exceptionHandler(aB,"Internal Error",2000)}},sessionDisconnectedHandler:function(az,ay){E("TB.sessionDisconnected("+ay+")");try{var ax=this.sessions[az];ax.disconnectComponents();ax.cleanupConnection();ax.connected=false;var aw=new Z(this.SESSION_DISCONNECTED,ay,true);ax.dispatchEvent(aw);var at=function(){if(!aw.isDefaultPrevented()){ax.cleanup()}};setTimeout(at,2)}catch(av){var au="TB.sessionDisconnected :: "+av;I(au);TB.exceptionHandler(au,"Internal Error",2000)}},streamCreatedHandler:function(ay,at,ax){E("TB.streamCreated");try{var aw=this.sessions[ay];var az=aa(at);aw.dispatchEvent(new a(this.STREAM_CREATED,az,ax))}catch(av){var au="TB.streamCreated :: "+av;I(au);TB.exceptionHandler(au,"Internal Error",2000)}},streamDestroyedHandler:function(aw,au,ax){E("TB.streamDestroyed");try{var aA=this.sessions[aw];var aB=aa(au);var at=new a(this.STREAM_DESTROYED,aB,ax,true);aA.dispatchEvent(at);var az=function(){if(!at.isDefaultPrevented()){for(var aD=0;aD<at.streams.length;aD++){var aF=aA.getSubscribersForStream(at.streams[aD]);for(var aC=0;aC<aF.length;aC++){aA.unsubscribe(aF[aC])}var aE=aA.getPublisherForStream(at.streams[aD]);if(aE){aA.unpublish(aE)}}}};setTimeout(az,2)}catch(av){var ay="TB.streamDestroyed :: "+av;I(ay);TB.exceptionHandler(ay,"Internal Error",2000)}},streamPropertyChangedHandler:function(az,ax,av,at,aw){E("TB.streamPropertyChangedHandler");var aC=this.sessions[az];var aD=C(ax);var au=new o(this.STREAM_PROPERTY_CHANGED,aD,av,at,aw);aC.dispatchEvent(au);try{var aE;if("hasAudio"==av){for(var aB in aC.subscribers){aE=aC.subscribers[aB];if(aE.hasOwnProperty("stream")&&aE.stream.streamId==aD.streamId){aE._subscribeToAudio(aw,true);break}}}else{if("hasVideo"==av){for(aB in aC.subscribers){aE=aC.subscribers[aB];if(aE.hasOwnProperty("stream")&&aE.stream.streamId==aD.streamId){aE._subscribeToVideo(aw,true);break}}}else{if("orientation"==av){for(aB in aC.subscribers){aE=aC.subscribers[aB];if(aE.hasOwnProperty("stream")&&aE.stream.streamId==aD.streamId){aE.changeOrientation(aw);break}}}else{E("Unknown property changed")}}}}catch(ay){var aA="TB.streamPropertyChangedHandler :: "+ay;I(aA);TB.exceptionHandler(aA,"Internal Error",2000)}},connectionCreatedHandler:function(az,at,ay){E("TB.connectionCreated");try{var ax=this.sessions[az];var au=ao(at);ax.dispatchEvent(new y(this.CONNECTION_CREATED,au,ay))}catch(aw){var av="TB.connectionCreated :: "+aw;I(av);TB.exceptionHandler(av,"Internal Error",2000)}},connectionDestroyedHandler:function(az,at,ay){E("TB.connectionDestroyed");try{var ax=this.sessions[az];var au=ao(at);ax.dispatchEvent(new y(this.CONNECTION_DESTROYED,au,ay))}catch(aw){var av="TB.connectionDestroyed :: "+aw;I(av);TB.exceptionHandler(av,"Internal Error",2000)}},signalHandler:function(ax,at){E("TB.signal");try{var aw=this.sessions[ax];aw.dispatchEvent(new r(this.SIGNAL_RECEIVED,D(at)))}catch(av){var au="TB.signal ::"+av;I(au);TB.exceptionHandler(au,"Internal Error",2000)}},groupPropertiesUpdatedHandler:function(ax,av){E("TB.groupPropertiesUpdated");try{var aw=this.groups[ax+"_"+av.groupId];if(!aw){I("TB.groupPropertiesUpdated :: Invalid group ID: "+ax+"_"+av.groupId);return}aw.dispatchEvent(new V(this.GROUP_PROPERTIES_UPDATED))}catch(au){var at="TB.groupPropertiesUpdated :: "+au;I(at);TB.exceptionHandler(at,"Internal Error",2000)}},videoComponentLoadedHandler:function(az,at){try{var ay=this.sessions[az];if(!ay){return}var ax=ay.publishers[at];var au=ay.subscribers[at];if(ax&&!ax.loaded){ax.loaded=true;if(ax.modified){if(ax.audioPublished!=null){ax.publishAudio(ax.audioPublished)}if(ax.videoPublished!=null){ax.publishVideo(ax.videoPublished)}ax.setMicrophoneGain(ax.gain);ax.setStyle(ax._style);ax.modified=false}ax.dispatchEvent(new V("loaded"))}if(au&&!au.loaded){au.loaded=true;if(au.modified){if(au.audioSubscribed!=null){au.subscribeToAudio(au.audioSubscribed)}if(au.videoSubscribed!=null){au.subscribeToVideo(au.videoSubscribed)}au.setAudioVolume(au.audioVolume);au.setStyle(au._style);au.modified=false}au.dispatchEvent(new V("loaded"))}}catch(aw){var av="videoComponentLoaded:: initialize component "+at+" - "+aw;I(av);TB.exceptionHandler(av,"Internal Error",2000)}},pubWidgetStyleHeightFrom:null,pubWidgetStyleWidthFrom:null,resizePublisherToTarget:function(az,aC){E("TB.resize");try{var aD=this.sessions[az];if(!aD){var aB="TB.resize :: Invalid session ID: "+az;I(aB);TB.exceptionHandler(aB,"Internal Error",2000);return}var at=aD.publishers[aC];if(!at){aB="TB.resize :: Invalid publisher ID: "+aC;I(aB);TB.exceptionHandler(aB,"Internal Error",2000);return}var au=document.getElementById(aC);if(!au){aB="TB.resize :: Publisher "+aC+" does not exist in the DOM";I(aB);TB.exceptionHandler(aB,"Internal Error",2000);return}var aA=au.width;var ay=au.height;if(au.width!=at.properties.width){au.width=at.properties.width}if(au.height!=at.properties.height){au.height=at.properties.height}if(au.style.height!=pubWidgetStyleHeightFrom){au.style.height=pubWidgetStyleHeightFrom}if(au.style.width!=pubWidgetStyleWidthFrom){au.style.width=pubWidgetStyleWidthFrom}var aw=au.width;var ax=au.height;if(aA!=aw||ay!=ax){at.dispatchEvent(new g(this.RESIZE,aA,aw,ay,ax))}}catch(av){aB="resizePublisherToTarget :: Error resizing publisher - "+av;I(aB);TB.exceptionHandler(aB,"Internal Error",2000)}},resizePublisherToShowSecurity:function(aA,aD,aF){E("TB.resize");var aE=this.sessions[aA];if(!aE){var aC="TB.resize :: Invalid session ID: "+aA;I(aC);TB.exceptionHandler(aC,"Internal Error",2000);return}var au=aE.publishers[aD];if(!au){aC="TB.resize :: Invalid publisher ID: "+aD;I(aC);TB.exceptionHandler(aC,"Internal Error",2000);return}var aw=document.getElementById(aD);if(!aw){aC="TB.resize :: Publisher "+aD+" does not exist in the DOM";I(aC);TB.exceptionHandler(aC,"Internal Error",2000);return}var aB=aw.width;var az=aw.height;pubWidgetStyleHeightFrom=aw.style.height;pubWidgetStyleWidthFrom=aw.style.width;var at=af*aF;var aG=Q*aF;if(aw.width<at){aw.width=at;aw.style.width=at+"px"}if(aw.height<aG){aw.height=aG;aw.style.height=aG+"px"}var ax=aw.width;var ay=aw.height;var av=aw.style;if(aB!=ax||az!=ay||pubWidgetStyleWidthFrom!=av.width||pubWidgetStyleHeightFrom!=av.height){au.dispatchEvent(new g(this.RESIZE,aB,ax,az,ay))}},settingsButtonClickHandler:function(aA,at){E("TB.settingsButtonClick");try{var az=this.sessions[aA];if(!az){var ay="TB.settingsButtonClick :: Invalid session ID: "+aA;I(ay);TB.exceptionHandler(ay,"Internal Error",2000);return}var ax=az.publishers[at];if(!ax){ay="TB.settingsButtonClick :: Invalid publisher ID: "+at;I(ay);TB.exceptionHandler(ay,"Internal Error",2000);return}var aw=new V(this.SETTINGS_BUTTON_CLICK,true);ax.dispatchEvent(aw);var au=function(){if(!aw.isDefaultPrevented()){var aB=TB.initDeviceManager(az.apiKey);aB.displayPanel(null,ax,{})}};setTimeout(au,2)}catch(av){ay="settingsButtonClick :: "+av;I(ay);TB.exceptionHandler(ay,"Internal Error",2000)}},deviceAccessHandler:function(aA,at,au){E("TB.deviceAccessHandler: "+au);try{var az=this.sessions[aA];if(!az){var ay="TB.deviceAccessHandler :: Invalid session ID: "+aA;I(ay);TB.exceptionHandler(ay,"Internal Error",2000);return}var ax=az.publishers[at];if(!ax){ay="TB.deviceAccessHandler :: Invalid publisher ID: "+at;I(ay);TB.exceptionHandler(ay,"Internal Error",2000);return}var aw=new V(au,true);ax.dispatchEvent(aw)}catch(av){ay=au+" :: "+av;I(ay);TB.exceptionHandler(ay,"Internal Error",2000)}},deviceInactiveHandler:function(aw,az,ay,aB){E("TB.deviceInactiveHandler");try{var aA=this.sessions[aw];if(!aA){var ax="TB.deviceInactiveHandler :: Invalid session ID: "+aw;I(ax);TB.exceptionHandler(ax,"Internal Error",2000);return}var at=aA.publishers[az];if(!at){I("TB.deviceInactiveHandler :: Invalid publisher ID: "+az);return}var au=new t(this.DEVICE_INACTIVE,ay,aB);at.dispatchEvent(au)}catch(av){ax="deviceInactive :: "+av;I(ax);TB.exceptionHandler(ax,"Internal Error",2000)}},echoCancellationModeChangedHandler:function(aw,az,ay,aB){E("TB.echoCancellationModeChangedHandler");try{var aA=this.sessions[aw];if(!aA){var ax="TB.echoCancellationModeChangedHandler :: Invalid session ID: "+aw;I(ax);TB.exceptionHandler(ax,"Internal Error",2000);return}var at=aA.publishers[az];if(!at){I("TB.echoCancellationModeChangedHandler :: Invalid publisher ID: "+az);return}var au=new t(this.ECHO_CANCELLATION_MODE_CHANGED,ay,aB);at.dispatchEvent(au)}catch(av){ax="echoCancellationModeChanged :: "+av;I(ax);TB.exceptionHandler(ax,"Internal Error",2000)}},devicesDetectedHandler:function(av,au,at,ax){E("TB.devicesDetected");try{var aw=q(av);var ay=j(au);Y.dispatchEvent(new v(this.DEVICES_DETECTED,aw,ay,aw[at],ay[ax]));setTimeout(function(){B(u,"devicesDetectedHandler :: ");u=null},0)}catch(aA){var az="devicesDetectedHandler :: "+aA;I(az);TB.exceptionHandler(az,"Internal Error",2000)}},devicesSelectedHandler:function(at,au,ax){E("TB.devicesSelected");try{b=true;var ay=Y.panels[at];if(!ay){I("TB.devicesSelected :: Invalid DevicePanel ID: "+at);return}if(ay.publisher){ay.publisher.setCamera(au);ay.publisher.setMicrophone(ax)}ay.dispatchEvent(new t(this.DEVICES_SELECTED,au,ax))}catch(aw){var av="devicesSelected :: "+aw;I(av);TB.exceptionHandler(av,"Internal Error",2000)}},closeButtonClickHandler:function(at){E("TB.closeButtonClick");try{var ay=Y.panels[at];if(!ay){var ax="TB.devicesSelected :: Invalid DevicePanel ID: "+at;I(ax);TB.exceptionHandler(ax,"Internal Error",2000);return}var aw=new V(this.CLOSE_BUTTON_CLICK,true);ay.dispatchEvent(aw);var au=function(){if(!aw.isDefaultPrevented()){Y.removePanel(ay)}};setTimeout(au,2)}catch(av){ax="closeButtonClick :: "+av;I(ax);TB.exceptionHandler(ax,"Internal Error",2000)}},reportIssueHandler:function(aK){E("TB.reportIssue");if(f){return}f=true;var av=document.createElement("form");av.setAttribute("action","http://www.tokbox.com/reportIssue.php");av.setAttribute("method","post");av.setAttribute("target","formresult");ab(av,"issueId",aK);ab(av,"userAgent",navigator.userAgent);ab(av,"environment","JS");var ay=swfobject.getFlashPlayerVersion();ab(av,"flashVersion",ay.major+"."+ay.minor+"."+ay.release);var aw=window.opentokdebug.getLogs();ab(av,"jsLogs",aw);var at=false;var aM=0;for(var aJ in TB.sessions){var au=TB.sessions[aJ];if(!au.hasOwnProperty("sessionId")){continue}if(!at){ab(av,"apiKey",au.apiKey);at=true}var aA=0;ab(av,"session_"+ ++aM,au.sessionId);var aD="controller_"+au.sessionId;var aO=s(aD);ab(av,"widget_"+au.sessionId+"_"+ ++aA,aO);if(au.hasOwnProperty("subscribers")){for(var aB in au.subscribers){if(au.subscribers[aB].hasOwnProperty("id")){var aL=s(au.subscribers[aB].id);ab(av,"widget_"+au.sessionId+"_"+ ++aA,aL)}}}if(au.hasOwnProperty("publishers")){var ax=0;for(var aG in au.publishers){if(au.publishers[aG].hasOwnProperty("id")){var aI=s(au.publishers[aG].id);ab(av,"widget_"+au.sessionId+"_"+ ++aA,aI)}}}}var aC=document.createElement("textarea");aC.setAttribute("name","description");aC.setAttribute("rows",8);aC.setAttribute("cols",40);aC.style.height="110px";aC.style.width="300px";aC.style.display="block";aC.style.visibility="visible";av.appendChild(aC);var aN=document.createElement("input");aN.setAttribute("type","submit");aN.setAttribute("value","Report Issue");aN.style.display="inline";aN.style.visibility="visible";av.appendChild(aN);var aF=document.createElement("input");aF.setAttribute("type","button");aF.setAttribute("value","Cancel");aF.style.display="inline";aF.style.visibility="visible";av.appendChild(aF);var aH=390;var aE=242;var az=document.createElement("div");az.setAttribute("id","opentokReportIssue");az.style.position="absolute";az.style.top="25%";az.style.left="50%";az.style.width=aH+"px";az.style.height=aE+"px";az.style.marginLeft=(0-aH/2)+"px";az.style.marginTop=(0-aE/4)+"px";az.style.paddingLeft="32px";az.style.paddingRight="15px";az.style.paddingTop="15px";az.style.display="block";az.style.visibility="visible";az.style.lineHeight="15px";az.innerHTML='<span style="color:#4c4c4c;font-size:18px;display:inline;visibility:visible;">We\'re sorry to hear that something went wrong.</span><br/><br/>Please help us to debug your issue by providing a description of what happened.';az.style.backgroundColor="#F7F7F7";az.style.border="1px solid #CCC";az.style.fontWeight="normal";az.style.fontFamily="'Lucida Grande', 'Trebuchet MS', sans-serif";az.style.color="#4c4c4c";az.style.fontSize="13px";az.appendChild(av);document.body.appendChild(az);closeForm=function(){document.body.removeChild(az);f=false};aF.onclick=closeForm;av.onsubmit=function(){window.open("#","formresult","scrollbars=no,menubar=no,height=200,width=400,resizable=yes,toolbar=no,status=no");setTimeout(function(){closeForm()},1000)}}}}();
/*
 * JavaScript Debug - v0.4 - 6/22/2010
 * http://benalman.com/projects/javascript-debug-console-log/
 *
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 */
window.opentokdebug=(function(){var i=this,b=Array.prototype.slice,d=i.console,h={},f,g,m=0,c=["error","warn","info","debug","log"],l="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),j=l.length,a=[];while(--j>=0){(function(n){h[n]=function(){m!==0&&d&&d[n]&&d[n].apply(d,arguments)}})(l[j])}j=c.length;while(--j>=0){(function(n,o){h[o]=function(){var q=b.call(arguments),p=[o].concat(q);a.push(p);if(!d||!k(n)){return}e(p);(d.firebug||i.Firebug)?d[o].apply(d,q):d[o]?d[o](q):d.log(q)}})(j,c[j])}function e(n){if(f&&(g||!d||!d.log)){f.apply(i,n)}}h.setLevel=function(n){m=typeof n==="number"?n:9};function k(n){return m>0?m>n:c.length+m<=n}h.setCallback=function(){var o=b.call(arguments),n=a.length,p=n;f=o.shift()||null;g=typeof o[0]==="boolean"?o.shift():false;p-=typeof o[0]==="number"?o.shift():n;while(p<n){e(a[p++])}};h.getLogs=function(){return a.join("\n")};return h})();
/*
 *	SWFObject v2.2 <http://code.google.com/p/swfobject/> 
 * 	is released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
 * 	
 * 	Permission is hereby granted, free of charge, to any person obtaining a copy
 * 	of this software and associated documentation files (the "Software"), to deal
 * 	in the Software without restriction, including without limitation the rights
 * 	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * 	copies of the Software, and to permit persons to whom the Software is
 * 	furnished to do so, subject to the following conditions:
 * 	
 * 	The above copyright notice and this permission notice shall be included in
 * 	all copies or substantial portions of the Software
 */
var swfobject=function(){var aq="undefined",aD="object",ab="Shockwave Flash",X="ShockwaveFlash.ShockwaveFlash",aE="application/x-shockwave-flash",ac="SWFObjectExprInst",ax="onreadystatechange",af=window,aL=document,aB=navigator,aa=false,Z=[aN],aG=[],ag=[],al=[],aJ,ad,ap,at,ak=false,aU=false,aH,an,aI=true,ah=function(){var a=typeof aL.getElementById!=aq&&typeof aL.getElementsByTagName!=aq&&typeof aL.createElement!=aq,e=aB.userAgent.toLowerCase(),c=aB.platform.toLowerCase(),h=c?/win/.test(c):/win/.test(e),j=c?/mac/.test(c):/mac/.test(e),g=/webkit/.test(e)?parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,d=!+"\v1",f=[0,0,0],k=null;if(typeof aB.plugins!=aq&&typeof aB.plugins[ab]==aD){k=aB.plugins[ab].description;if(k&&!(typeof aB.mimeTypes!=aq&&aB.mimeTypes[aE]&&!aB.mimeTypes[aE].enabledPlugin)){aa=true;d=false;k=k.replace(/^.*\s+(\S+\s+\S+$)/,"$1");f[0]=parseInt(k.replace(/^(.*)\..*$/,"$1"),10);f[1]=parseInt(k.replace(/^.*\.(.*)\s.*$/,"$1"),10);f[2]=/[a-zA-Z]/.test(k)?parseInt(k.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof af.ActiveXObject!=aq){try{var i=new ActiveXObject(X);if(i){k=i.GetVariable("$version");if(k){d=true;k=k.split(" ")[1].split(",");f=[parseInt(k[0],10),parseInt(k[1],10),parseInt(k[2],10)]}}}catch(b){}}}return{w3:a,pv:f,wk:g,ie:d,win:h,mac:j}}(),aK=function(){if(!ah.w3){return}if((typeof aL.readyState!=aq&&aL.readyState=="complete")||(typeof aL.readyState==aq&&(aL.getElementsByTagName("body")[0]||aL.body))){aP()}if(!ak){if(typeof aL.addEventListener!=aq){aL.addEventListener("DOMContentLoaded",aP,false)}if(ah.ie&&ah.win){aL.attachEvent(ax,function(){if(aL.readyState=="complete"){aL.detachEvent(ax,arguments.callee);aP()}});if(af==top){(function(){if(ak){return}try{aL.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}aP()})()}}if(ah.wk){(function(){if(ak){return}if(!/loaded|complete/.test(aL.readyState)){setTimeout(arguments.callee,0);return}aP()})()}aC(aP)}}();function aP(){if(ak){return}try{var b=aL.getElementsByTagName("body")[0].appendChild(ar("span"));b.parentNode.removeChild(b)}catch(a){return}ak=true;var d=Z.length;for(var c=0;c<d;c++){Z[c]()}}function aj(a){if(ak){a()}else{Z[Z.length]=a}}function aC(a){if(typeof af.addEventListener!=aq){af.addEventListener("load",a,false)}else{if(typeof aL.addEventListener!=aq){aL.addEventListener("load",a,false)}else{if(typeof af.attachEvent!=aq){aM(af,"onload",a)}else{if(typeof af.onload=="function"){var b=af.onload;af.onload=function(){b();a()}}else{af.onload=a}}}}}function aN(){if(aa){Y()}else{am()}}function Y(){var d=aL.getElementsByTagName("body")[0];var b=ar(aD);b.setAttribute("type",aE);var a=d.appendChild(b);if(a){var c=0;(function(){if(typeof a.GetVariable!=aq){var e=a.GetVariable("$version");if(e){e=e.split(" ")[1].split(",");ah.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]}}else{if(c<10){c++;setTimeout(arguments.callee,10);return}}d.removeChild(b);a=null;am()})()}else{am()}}function am(){var g=aG.length;if(g>0){for(var h=0;h<g;h++){var c=aG[h].id;var l=aG[h].callbackFn;var a={success:false,id:c};if(ah.pv[0]>0){var i=aS(c);if(i){if(ao(aG[h].swfVersion)&&!(ah.wk&&ah.wk<312)){ay(c,true);if(l){a.success=true;a.ref=av(c);l(a)}}else{if(aG[h].expressInstall&&au()){var e={};e.data=aG[h].expressInstall;e.width=i.getAttribute("width")||"0";e.height=i.getAttribute("height")||"0";if(i.getAttribute("class")){e.styleclass=i.getAttribute("class")}if(i.getAttribute("align")){e.align=i.getAttribute("align")}var f={};var d=i.getElementsByTagName("param");var k=d.length;for(var j=0;j<k;j++){if(d[j].getAttribute("name").toLowerCase()!="movie"){f[d[j].getAttribute("name")]=d[j].getAttribute("value")}}ae(e,f,c,l)}else{aF(i);if(l){l(a)}}}}}else{ay(c,true);if(l){var b=av(c);if(b&&typeof b.SetVariable!=aq){a.success=true;a.ref=b}l(a)}}}}}function av(b){var d=null;var c=aS(b);if(c&&c.nodeName=="OBJECT"){if(typeof c.SetVariable!=aq){d=c}else{var a=c.getElementsByTagName(aD)[0];if(a){d=a}}}return d}function au(){return !aU&&ao("6.0.65")&&(ah.win||ah.mac)&&!(ah.wk&&ah.wk<312)}function ae(f,d,h,e){aU=true;ap=e||null;at={success:false,id:h};var a=aS(h);if(a){if(a.nodeName=="OBJECT"){aJ=aO(a);ad=null}else{aJ=a;ad=h}f.id=ac;if(typeof f.width==aq||(!/%$/.test(f.width)&&parseInt(f.width,10)<310)){f.width="310"}if(typeof f.height==aq||(!/%$/.test(f.height)&&parseInt(f.height,10)<137)){f.height="137"}aL.title=aL.title.slice(0,47)+" - Flash Player Installation";var b=ah.ie&&ah.win?"ActiveX":"PlugIn",c="MMredirectURL="+af.location.toString().replace(/&/g,"%26")+"&MMplayerType="+b+"&MMdoctitle="+aL.title;if(typeof d.flashvars!=aq){d.flashvars+="&"+c}else{d.flashvars=c}if(ah.ie&&ah.win&&a.readyState!=4){var g=ar("div");h+="SWFObjectNew";g.setAttribute("id",h);a.parentNode.insertBefore(g,a);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}aA(f,d,h)}}function aF(a){if(ah.ie&&ah.win&&a.readyState!=4){var b=ar("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(aO(a),b);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}else{a.parentNode.replaceChild(aO(a),a)}}function aO(b){var d=ar("div");if(ah.win&&ah.ie){d.innerHTML=b.innerHTML}else{var e=b.getElementsByTagName(aD)[0];if(e){var a=e.childNodes;if(a){var f=a.length;for(var c=0;c<f;c++){if(!(a[c].nodeType==1&&a[c].nodeName=="PARAM")&&!(a[c].nodeType==8)){d.appendChild(a[c].cloneNode(true))}}}}}return d}function aA(e,g,c){var d,a=aS(c);if(ah.wk&&ah.wk<312){return d}if(a){if(typeof e.id==aq){e.id=c}if(ah.ie&&ah.win){var f="";for(var i in e){if(e[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){g.movie=e[i]}else{if(i.toLowerCase()=="styleclass"){f+=' class="'+e[i]+'"'}else{if(i.toLowerCase()!="classid"){f+=" "+i+'="'+e[i]+'"'}}}}}var h="";for(var j in g){if(g[j]!=Object.prototype[j]){h+='<param name="'+j+'" value="'+g[j]+'" />'}}a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>";ag[ag.length]=e.id;d=aS(e.id)}else{var b=ar(aD);b.setAttribute("type",aE);for(var k in e){if(e[k]!=Object.prototype[k]){if(k.toLowerCase()=="styleclass"){b.setAttribute("class",e[k])}else{if(k.toLowerCase()!="classid"){b.setAttribute(k,e[k])}}}}for(var l in g){if(g[l]!=Object.prototype[l]&&l.toLowerCase()!="movie"){aQ(b,l,g[l])}}a.parentNode.replaceChild(b,a);d=b}}return d}function aQ(b,d,c){var a=ar("param");a.setAttribute("name",d);a.setAttribute("value",c);b.appendChild(a)}function aw(a){var b=aS(a);if(b&&b.nodeName=="OBJECT"){if(ah.ie&&ah.win){b.style.display="none";(function(){if(b.readyState==4){aT(a)}else{setTimeout(arguments.callee,10)}})()}else{b.parentNode.removeChild(b)}}}function aT(a){var b=aS(a);if(b){for(var c in b){if(typeof b[c]=="function"){b[c]=null}}b.parentNode.removeChild(b)}}function aS(a){var c=null;try{c=aL.getElementById(a)}catch(b){}return c}function ar(a){return aL.createElement(a)}function aM(a,c,b){a.attachEvent(c,b);al[al.length]=[a,c,b]}function ao(a){var b=ah.pv,c=a.split(".");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10)||0;c[2]=parseInt(c[2],10)||0;return(b[0]>c[0]||(b[0]==c[0]&&b[1]>c[1])||(b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]))?true:false}function az(b,f,a,c){if(ah.ie&&ah.mac){return}var e=aL.getElementsByTagName("head")[0];if(!e){return}var g=(a&&typeof a=="string")?a:"screen";if(c){aH=null;an=null}if(!aH||an!=g){var d=ar("style");d.setAttribute("type","text/css");d.setAttribute("media",g);aH=e.appendChild(d);if(ah.ie&&ah.win&&typeof aL.styleSheets!=aq&&aL.styleSheets.length>0){aH=aL.styleSheets[aL.styleSheets.length-1]}an=g}if(ah.ie&&ah.win){if(aH&&typeof aH.addRule==aD){aH.addRule(b,f)}}else{if(aH&&typeof aL.createTextNode!=aq){aH.appendChild(aL.createTextNode(b+" {"+f+"}"))}}}function ay(a,c){if(!aI){return}var b=c?"visible":"hidden";if(ak&&aS(a)){aS(a).style.visibility=b}else{az("#"+a,"visibility:"+b)}}function ai(b){var a=/[\\\"<>\.;]/;var c=a.exec(b)!=null;return c&&typeof encodeURIComponent!=aq?encodeURIComponent(b):b}var aR=function(){if(ah.ie&&ah.win){window.attachEvent("onunload",function(){var a=al.length;for(var b=0;b<a;b++){al[b][0].detachEvent(al[b][1],al[b][2])}var d=ag.length;for(var c=0;c<d;c++){aw(ag[c])}for(var e in ah){ah[e]=null}ah=null;for(var f in swfobject){swfobject[f]=null}swfobject=null})}}();return{registerObject:function(a,e,c,b){if(ah.w3&&a&&e){var d={};d.id=a;d.swfVersion=e;d.expressInstall=c;d.callbackFn=b;aG[aG.length]=d;ay(a,false)}else{if(b){b({success:false,id:a})}}},getObjectById:function(a){if(ah.w3){return av(a)}},embedSWF:function(k,e,h,f,c,a,b,i,g,j){var d={success:false,id:e};if(ah.w3&&!(ah.wk&&ah.wk<312)&&k&&e&&h&&f&&c){ay(e,false);aj(function(){h+="";f+="";var q={};if(g&&typeof g===aD){for(var o in g){q[o]=g[o]}}q.data=k;q.width=h;q.height=f;var n={};if(i&&typeof i===aD){for(var p in i){n[p]=i[p]}}if(b&&typeof b===aD){for(var l in b){if(typeof n.flashvars!=aq){n.flashvars+="&"+l+"="+b[l]}else{n.flashvars=l+"="+b[l]}}}if(ao(c)){var m=aA(q,n,e);if(q.id==e){ay(e,true)}d.success=true;d.ref=m}else{if(a&&au()){q.data=a;ae(q,n,e,j);return}else{ay(e,true)}}if(j){j(d)}})}else{if(j){j(d)}}},switchOffAutoHideShow:function(){aI=false},ua:ah,getFlashPlayerVersion:function(){return{major:ah.pv[0],minor:ah.pv[1],release:ah.pv[2]}},hasFlashPlayerVersion:ao,createSWF:function(a,b,c){if(ah.w3){return aA(a,b,c)}else{return undefined}},showExpressInstall:function(b,a,d,c){if(ah.w3&&au()){ae(b,a,d,c)}},removeSWF:function(a){if(ah.w3){aw(a)}},createCSS:function(b,a,c,d){if(ah.w3){az(b,a,c,d)}},addDomLoadEvent:aj,addLoadEvent:aC,getQueryParamValue:function(b){var a=aL.location.search||aL.location.hash;if(a){if(/\?/.test(a)){a=a.split("?")[1]}if(b==null){return ai(a)}var c=a.split("&");for(var d=0;d<c.length;d++){if(c[d].substring(0,c[d].indexOf("="))==b){return ai(c[d].substring((c[d].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(aU){var a=aS(ac);if(a&&aJ){a.parentNode.replaceChild(aJ,a);if(ad){ay(ad,true);if(ah.ie&&ah.win){aJ.style.display="block"}}if(ap){ap(at)}}aU=false}}}}();